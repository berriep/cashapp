{
  "swagger": "2.0",
  "info": {
    "description": "Business Account Insight - Balance API allows you to fetch the actual balance for one or more connected payment and or savings accounts for a specific Rabobank customer using a valid certificate and request signature.\n<br>\n\n## **Before you begin**\n\nMake sure you have a working sandbox account in the [Rabobank developer portal](https://developer.rabobank.nl/). Read [Get Started](https://developer.rabobank.nl/get-started) to set up an account and register an **Application**.\n\n**NOTE:** To use these API(s), a valid [TLS](https://developer.rabobank.nl/how-use-mutual-tls) certificate is required.\n<br>\n\n## **Using the API**\n\nAfter your account set up is complete, subscribe the **Business Account Insight** and the **Authorization Services** API to your application.\n\nMake sure to use the **Authorization** and **Token URL** as provided by the [**Authorization Services**](https://developer.rabobank.nl/using-premium-access-authorization-access-rabobank-apis).\n\n**Tip**: To learn how to sign a request, read [**Signing requests for the Business Account Insight APIs**](https://developer.rabobank.nl/signing-requests-business-account-insight-apis).\n<br>\n\n## **Requests**\n\nThe GET balances requests must contain a digital signature. You can generate this digital signature using the private key of your certificate. For the Sandbox environment, you can use an example certificate available in the [Signing documentation](https://developer.rabobank.nl/signing-requests-business-account-insight-apis).\n<br>\nYou can retrieve the balance of a specific account using a GET accounts/{account-id}/balances request using the account-id(s) in the URL:\n```\n  GET https://api-sandbox.rabobank.nl/openapi/sandbox/payments/insight/accounts/Wp-xhZMGEWRIIgVjPwTC1aKJJ0VCRZ_4bScUVXof7e0/balances\n```\nThis returns the current expected and iterimBooked balance, also the closingBooked balance from the day before.\n\n**Historical EODB balances of a specific account**\n\nTo retrieve historical EODB balances of a specific account, use closingBookedReferenceDate in the query param, as below:\n\n**Example:**\n```\n  GET https://api-sandbox.rabobank.nl/openapi/sandbox/payments/insight/accounts/Wp-xhZMGEWRIIgVjPwTC1aKJJ0VCRZ_4bScUVXof7e0/balances?closingBookedReferenceDate=2024-10-30\n```\n<div class=\"apiDocsBlock apiDocsBlock--warning \">\n  <div class=\"apiDocsBlock__inner\">\n    <span class=\"apiDocsBlock__icon\" aria-hidden=\"true\"></span>\n    <div class=\"apiDocsBlock__content\">\n      closingBookedReferenceDate must contain a date in the past up to 15 months.\n    </div>\n  </div>\n</div>\n\nThis returns the requested closingBooked balance with the ReferenceDate, along with the current expected and iterimBooked balance.\n\n<br>To view full list of GET parameters, go to:\n- GET/accounts/{account-id}/balances\n</br>\n\n ## **Response**\nTo view the GET parameters, read the endpoint description for GET/accounts/{account-id}/balances.\n\n <div class=\"apiDocsBlock apiDocsBlock--warning \">\n  <div class=\"apiDocsBlock__inner\">\n    <span class=\"apiDocsBlock__icon\" aria-hidden=\"true\"></span>\n    <div class=\"apiDocsBlock__content\">\n      Availability of last booked balance\n      <br><br>\n      The closingBooked balances are calculated in the first hour after midnight. During the calculation, the closingBooked balances are not available and only the expected and interimBooked balances are returned.\n    </div>\n  </div>\n</div>\n\n<div class=\"apiDocsBlock apiDocsBlock--warning \">\n  <div class=\"apiDocsBlock__inner\">\n    <span class=\"apiDocsBlock__icon\" aria-hidden=\"true\"></span>\n    <div class=\"apiDocsBlock__content\">\n      The interim booked balance is not available for savingsaccounts.\n    </div>\n  </div>\n</div>\n\nTo view the expected errors, go to [Errors BAI](https://developer.rabobank.nl/errors-business-account-insight).\n\n```\n  {\n    \"account\": {\n      \"currency\": \"EUR\",\n      \"iban\": \"NL52RABO0125618484\"\n    },\n    \"balances\": [\n      {\n        \"balanceAmount\": {\n          \"amount\": \"10\",\n          \"currency\": \"EUR\"\n        },\n        \"balanceType\": \"expected\",\n        \"lastChangeDateTime\": \"2023-02-01T14:12:17.000Z\"\n      },\n      {\n        \"balanceAmount\": {\n          \"amount\": \"30\",\n          \"currency\": \"EUR\"\n        },\n        \"balanceType\": \"closingBooked\",\n        \"referenceDate\": \"2023-01-31\"\n      },\n     {\n        \"balanceAmount\": {\n          \"amount\": \"200\",\n          \"currency\": \"EUR\"\n        },\n        \"balanceType\": \"interimBooked\",\n        \"lastChangeDateTime\": \"2023-02-01T14:07:17.000Z\"\n      }\n    ], \n    \"piggyBanks\":[\n      {\n         \"piggyBankName\":\"Car\",\n         \"piggyBankBalance\":\"1200.00\"\n      },\n      {\n         \"piggyBankName\":\"Vacation\",\n         \"piggyBankBalance\":\"800.00\"\n      }\n    ]\n  }\n```\n\n<div class=\"apiDocsBlock apiDocsBlock--warning \">\n  <div class=\"apiDocsBlock__inner\">\n    <span class=\"apiDocsBlock__icon\" aria-hidden=\"true\"></span>\n    <div class=\"apiDocsBlock__content\">\n      To access piggy bank information, users must provide separate consent. When consent is given all existing savings piggy banks are returned in the response. \n      <br><br>\n      If there are no piggy banks related to the account, only the account balances are provided.\n    </div>\n  </div>\n</div>\n\nAccount-id's present in the Sandbox environment:\n\n| IBAN                  | account-id                                  |\n|-----------------      |---------------------------------------------|\n| NL52RABO0125618484    | Wp-xhZMGEWRIIgVjPwTC1aKJJ0VCRZ_4bScUVXof7e0 |\n| NL80RABO1127000002    | hBS4MQ0Oc4LLJRiUiE_R94_-zoU4B2vwnPkXmsGh_bA |",
    "version": "1.1.37",
    "title": "Business-Account-Insight-Balances",
    "x-ibm-name": "business-account-insight-balances"
  },
  "host": "api.rabobank.nl",
  "basePath": "/openapi/payments/insight",
  "schemes": [
    "https"
  ],
  "produces": [
    "application/json"
  ],
  "security": [
    {
      "clientId": [],
      "oauth2 access code flow": [
        "bai.accountinformation.read"
      ]
    },
    {
      "clientId": [],
      "oauth2 access code flow": [
        "bai.piggybanks.read"
      ]
    }
  ],
  "paths": {
    "/accounts/{account-id}/balances": {
      "get": {
        "summary": "Read Balance",
        "description": "Delivers the actual and Interim Booked Balance and end of day balance for a specific consented payment account and delivers the actual and end of day balance for a specific consented saving account.",
        "operationId": "getBalances",
        "parameters": [
          {
            "name": "account-id",
            "in": "path",
            "description": "This is the internal id of the particular IBAN and present in the response of the Read Account List call. Its value is constant throughout the lifecycle of a given consent.",
            "required": true,
            "type": "string",
            "x-example": "Wp-xhZMGEWRIIgVjPwTC1aKJJ0VCRZ_4bScUVXof7e0 AND hBS4MQ0Oc4LLJRiUiE_R94_-zoU4B2vwnPkXmsGh_b"
          },
          {
            "name": "Signature-Certificate",
            "in": "header",
            "description": "Public certificate of the Initiating Party that corresponds with the signature made by the Initiating Party.",
            "required": false,
            "type": "string",
            "format": "byte",
            "x-example": "MIIDkDCCAnigAwIBAgIEWs3AJDANBgkqhkiG9w0BAQsFADCBiTELMAkGA1UEBhMCTkwxEDAOBgNVBAgMB1V0cmVjaHQxEDAOBgNVBAcMB1V0cmVjaHQxETAPBgNVBAoMCFJhYm9iYW5rMRwwGgYDVQQLDBNPbmxpbmUgVHJhbnNhY3Rpb25zMSUwIwYDVQQDDBxQU0QyIEFQSSBQSSBTZXJ2aWNlcyBTYW5kYm94MB4XDTE4MDQxMTA3NTgyOFoXDTIzMDQxMTA3NTgyOFowgYkxCzAJBgNVBAYTAk5MMRAwDgYDVQQIDAdVdHJlY2h0MRAwDgYDVQQHDAdVdHJlY2h0MREwDwYDVQQKDAhSYWJvYmFuazEcMBoGA1UECwwTT25saW5lIFRyYW5zYWN0aW9uczElMCMGA1UEAwwcUFNEMiBBUEkgUEkgU2VydmljZXMgU2FuZGJveDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANoAjqGWUgCIm2F+0sBSEwLal+T3u+uldLikpxHCB8iL1GD7FrRjcA+MVsxhvHly7vRsHK+tQyMSaeK782RHpY33qxPLc8LmoQLb2EuiQxXj9POYkYBQ74qkrZnvKVlR3WoyQWeDOXnSY2wbNFfkP8ET4ElwyuIIEriwYhab0OIrnnrO8X82/SPZxHwEd3aQjQ6uhiw8paDspJbS5WjEfuwY16KVVUYlhbtAwGjvc6aK0NBm+LH9fMLpAE6gfGZNy0gzMDorVNbkQK1IoAGD8p9ZHdB0F3FwkILEjUiQW6nK+/fKDNJ0TBbpgZUpY8bR460qzxKdeZ1yPDqX2Cjh6fkCAwEAATANBgkqhkiG9w0BAQsFAAOCAQEAYL4iD6noMJAt63kDED4RB2mII/lssvHhcxuDpOm3Ims9urubFWEpvV5TgIBAxy9PBinOdjhO1kGJJnYi7F1jv1qnZwTV1JhYbvxv3+vk0jaiu7Ew7G3ASlzruXyMhN6t6jk9MpaWGl5Uw1T+gNRUcWQRR44g3ahQRIS/UHkaV+vcpOa8j186/1X0ULHfbcVQk4LMmJeXqNs8sBAUdKU/c6ssvj8jfJ4SfrurcBhY5UBTOdQOXTPY85aU3iFloerx7Oi9EHewxInOrU5XzqqTz2AQPXezexVeAQxP27lzqCmYC7CFiam6QBr06VebkmnPLfs76n8CDc1cwE6gUl0rMA=="
          },
          {
            "name": "X-Request-ID",
            "in": "header",
            "description": "ID of the request, unique to the call, as determined by the initiating party.",
            "required": true,
            "type": "string",
            "format": "uuid",
            "x-example": "594d27d0-26d7-47dc-9d62-c307616220b6"
          },
          {
            "name": "Digest",
            "in": "header",
            "description": "The digest is a base64 encoded hash of the body (SHA-512 or SHA-256 is allowed).",
            "required": true,
            "type": "string",
            "x-example": "sha-512=z4PhNX7vuL3xVChQ1m2AB9Yg5AULVxXcg/SpIdNs6c5H0NE8XYXysP+DGNKHfuwvY7kxvUdBeoGlODJ6+SfaPg=="
          },
          {
            "name": "Signature",
            "in": "header",
            "description": "Signature is made up of the headers - date, digest and x-request-id. For more information see additional documentation in portal.",
            "required": true,
            "type": "string",
            "x-example": "keyId=\"1523433508\",algorithm=\"rsa-sha512\",headers=\"date digest x-request-id\",signature=\"ckfJsOBu3DRPVQzqIpwte8tUMxg6Mb6ThuA7hH3LuvZtjr8DS4OIKCRPTuC0IgyoCsUciD4CIa2hOWTZHf5tdQsXpruyem7GldFUA2zQFErC9wtAFxGSRs4f+sIKiX5knY//snxlq7xrZVtLc/jqBOBvy/X771SE2GIjtODVO3dcjXR5lnFIc+7uQBSXji9q13JhdJrkNJQt+XlbE0Z5FDTWsu1ZfLa+5Ky7S7+RGANyI02nCekHYc3Un8qdv3g46zw1TubL+HtZyao9mUor576jGiI/gBu9in/IXbZ7typ9kaAmN9iNR1Cw/9sbPJUtydTt1TWn0JWifPtr/+FjBQ==\""
          },
          {
            "name": "Date",
            "in": "header",
            "description": "Standard https header element with date, time and timezone.",
            "required": true,
            "type": "string",
            "x-example": "Tue, 15 Nov 2020 08:12:31 GMT"
          },
          {
            "name": "closingBookedReferenceDate",
            "in": "query",
            "description": "Reference date to receive historical closingBooked balances from yesterday up to 15 months in the past.",
            "required": false,
            "type": "string",
            "format": "date",
            "x-example": "2024-10-30"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "headers": {
              "X-RateLimit-Limit": {
                "type": "string",
                "description": "Maximum number of allowed requests",
                "x-example": "100"
              },
              "X-RateLimit-Remaining": {
                "type": "string",
                "description": "Remaining count",
                "x-example": "44"
              },
              "X-RateLimit-Reset": {
                "type": "string",
                "description": "Expiry time in seconds",
                "x-example": "10"
              },
              "X-Request-ID": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the request, unique to the call, as determined by the initiating party.",
                "x-example": "594d27d0-26d7-47dc-9d62-c307616220b6"
              }
            },
            "schema": {
              "$ref": "#/definitions/balanceResponse"
            }
          },
          "400": {
            "description": "Bad Request",
            "headers": {
              "X-Request-ID": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the request, unique to the call, as determined by the initiating party."
              }
            },
            "schema": {
              "$ref": "#/definitions/tppMessages"
            }
          },
          "401": {
            "description": "Unauthorized",
            "headers": {
              "X-Request-ID": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the request, unique to the call, as determined by the initiating party."
              }
            },
            "schema": {
              "$ref": "#/definitions/tppMessages"
            }
          },
          "403": {
            "description": "Forbidden",
            "headers": {
              "X-Request-ID": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the request, unique to the call, as determined by the initiating party."
              }
            },
            "schema": {
              "$ref": "#/definitions/tppMessages"
            }
          },
          "404": {
            "description": "Not found",
            "headers": {
              "X-Request-ID": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the request, unique to the call, as determined by the initiating party."
              }
            },
            "schema": {
              "$ref": "#/definitions/tppMessages"
            }
          },
          "405": {
            "description": "Method Not Allowed",
            "headers": {
              "X-Request-ID": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the request, unique to the call, as determined by the initiating party."
              }
            },
            "schema": {
              "$ref": "#/definitions/tppMessages"
            }
          },
          "406": {
            "description": "Not Acceptable",
            "headers": {
              "X-Request-ID": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the request, unique to the call, as determined by the initiating party."
              }
            },
            "schema": {
              "$ref": "#/definitions/tppMessages"
            }
          },
          "408": {
            "description": "Request Timeout",
            "headers": {
              "X-Request-ID": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the request, unique to the call, as determined by the initiating party."
              }
            }
          },
          "415": {
            "description": "Unsupported Media Type",
            "headers": {
              "X-Request-ID": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the request, unique to the call, as determined by the initiating party."
              }
            }
          },
          "429": {
            "description": "Too Many Requests",
            "headers": {
              "X-Request-ID": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the request, unique to the call, as determined by the initiating party."
              }
            },
            "schema": {
              "$ref": "#/definitions/tppMessages"
            }
          },
          "500": {
            "description": "Internal Server Error",
            "headers": {
              "X-Request-ID": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the request, unique to the call, as determined by the initiating party."
              }
            }
          },
          "503": {
            "description": "Service Unavailable",
            "headers": {
              "X-Request-ID": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the request, unique to the call, as determined by the initiating party."
              }
            }
          }
        }
      }
    }
  },
  "securityDefinitions": {
    "oauth2 access code flow": {
      "description": "NOTE Please use the Authorization and Token URL as provided by the oAuth2 Services",
      "type": "oauth2",
      "authorizationUrl": "https://oauth.rabobank.nl/openapi/oauth2-premium/authorize",
      "tokenUrl": "https://oauth.rabobank.nl/openapi/oauth2-premium/token",
      "flow": "accessCode",
      "scopes": {
        "bai.accountinformation.read": "Allow read from Business Account Insight services",
        "bai.piggybanks.read": "Allow read for Piggy Banks from Business Account Insight services"
      },
      "x-ibm-oauth-provider": "access-authorization-1-0-0-8e24"
    },
    "clientId": {
      "description": "ClientId as provided by the Rabobank developer portal.",
      "type": "apiKey",
      "name": "X-IBM-Client-Id",
      "in": "header"
    }
  },
  "definitions": {
    "accountReferenceIban": {
      "type": "object",
      "properties": {
        "currency": {
          "$ref": "#/definitions/currencyCode"
        },
        "iban": {
          "$ref": "#/definitions/iban"
        }
      },
      "description": "Reference to an account by the Primary Account Number (PAN) of a card,\ncan be tokenised by the ASPSP due to PCI DSS requirements.\n"
    },
    "amount": {
      "type": "object",
      "properties": {
        "amount": {
          "$ref": "#/definitions/amountValue"
        },
        "currency": {
          "$ref": "#/definitions/currencyCode"
        }
      },
      "example": {
        "amount": "10",
        "currency": "EUR"
      }
    },
    "amountValue": {
      "type": "string",
      "pattern": "-?[0-9]{1,14}(\\.[0-9]{1,3})?",
      "description": "The amount given with fractional digits, where fractions must be compliant to the currency definition.\nUp to 14 significant figures. Negative amounts are signed by minus.\nThe decimal separator is a dot.\n\n\n**Example:**\nValid representations for EUR with up to two decimals are:\n\n\n\n  * 1056\n\n  * 5768.2\n\n  * -1.50\n\n  * 5877.78\n",
      "example": "5877.78"
    },
    "balance": {
      "type": "object",
      "properties": {
        "balanceAmount": {
          "$ref": "#/definitions/amount"
        },
        "balanceType": {
          "$ref": "#/definitions/balanceType"
        },
        "lastChangeDateTime": {
          "type": "string",
          "example": "2023-02-01T14:07:17.000Z"
        },
        "referenceDate": {
          "type": "string",
          "example": "2023-01-31"
        }
      },
      "description": "A single balance element"
    },
    "balanceList": {
      "type": "array",
      "description": "A list of balances regarding this account e.g. the expected balance, interim booked balance and the last booked balance.\nThe list might be restricted to the expected balance and interim booked balance.\n",
      "items": {
        "$ref": "#/definitions/balance"
      }
    },
    "balanceType": {
      "type": "string",
      "example": "expected",
      "enum": [
        "closingBooked",
        "expected",
        "interimBooked"
      ]
    },
    "currencyCode": {
      "type": "string",
      "pattern": "[A-Z]{3}",
      "description": "ISO 4217 Alpha 3 currency code",
      "example": "EUR"
    },
    "iban": {
      "type": "string",
      "pattern": "[A-Z]{2,2}[0-9]{2,2}[a-zA-Z0-9]{1,30}",
      "description": "IBAN of an account",
      "example": "NL52RABO0125618484"
    },
    "messageCodeText": {
      "type": "string",
      "example": "CERTIFICATE_INVALID",
      "enum": [
        "SESSIONS_NOT_SUPPORTED",
        "ACCESS_EXCEEDED",
        "REQUESTED_FORMATS_INVALID",
        "CERTIFICATE_INVALID",
        "CERTIFICATE_EXPIRED",
        "CERTIFICATE_BLOCKED",
        "CERTIFICATE_REVOKED",
        "CERTIFICATE_MISSING",
        "SIGNATURE_INVALID",
        "SIGNATURE_MISSING",
        "FORMAT_ERROR",
        "PARAMETER_NOT_SUPPORTED",
        "SERVICE_INVALID",
        "SERVICE_BLOCKED",
        "CORPORATE_ID_INVALID",
        "CONSENT_UNKNOWN",
        "CONSENT_INVALID",
        "CONSENT_EXPIRED",
        "TOKEN_UNKNOWN",
        "TOKEN_INVALID",
        "TOKEN_EXPIRED",
        "RESOURCE_UNKNOWN",
        "RESOURCE_EXPIRED",
        "TIMESTAMP_INVALID",
        "PERIOD_INVALID",
        "SCA_METHOD_UNKNOWN"
      ]
    },
    "piggyBankList": {
      "type": "array",
      "description": "Optional list of piggy banks, it will only appear when piggy banks exist and correct consent is present.\n",
      "items": {
        "$ref": "#/definitions/piggyBank"
      }
    },
    "piggyBank": {
      "type": "object",
      "properties": {
        "piggyBankBalance": {
          "type": "string",
          "example": "1000.00"
        },
        "piggyBankName": {
          "type": "string",
          "example": "Vacation"
        }
      }
    },
    "balanceResponse": {
      "type": "object",
      "properties": {
        "account": {
          "$ref": "#/definitions/accountReferenceIban"
        },
        "balances": {
          "$ref": "#/definitions/balanceList"
        },
        "piggyBanks": {
          "$ref": "#/definitions/piggyBankList"
        }
      },
      "description": "Body of the response for a successful read balance request."
    },
    "tppMessageCategory": {
      "type": "string",
      "description": "Category of the message",
      "example": "ERROR",
      "enum": [
        "ERROR",
        "WARNING"
      ]
    },
    "tppMessageGeneric": {
      "type": "object",
      "properties": {
        "category": {
          "$ref": "#/definitions/tppMessageCategory"
        },
        "code": {
          "$ref": "#/definitions/messageCodeText"
        },
        "path": {
          "type": "string"
        },
        "text": {
          "$ref": "#/definitions/tppMessageText"
        }
      }
    },
    "tppMessageText": {
      "type": "string",
      "maxLength": 512,
      "description": "Additional text.",
      "example": "Header X-Request-ID is required"
    },
    "tppMessages": {
      "properties": {
        "tppMessages": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/tppMessageGeneric"
          }
        }
      },
      "description": "Messages on operational issues."
    }
  },
  "x-ibm-configuration": {
    "cors": {
      "enabled": false
    },
    "enforced": true,
    "phase": "realized",
    "type": "rest",
    "testable": false,
    "application-authentication": {
      "certificate": true
    },
    "servers": [
      {
        "url": "https://api.rabobank.nl/openapi/payments/insight",
        "description": "",
        "type": [
          "production",
          "development"
        ]
      }
    ],
    "oauth-servers": {
      "oauth2 access code flow": {
        "tokenUrls": [
          "https://oauth.rabobank.nl/openapi/oauth2-premium/token"
        ],
        "authorizationUrls": [
          "https://oauth.rabobank.nl/openapi/oauth2-premium/authorize"
        ],
        "refreshUrls": []
      }
    }
  }
}